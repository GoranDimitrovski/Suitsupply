/*!
 * suitsupply
 * 
 * 
 * @author Goran Dimitrovski
 * @version 1.0.0
 * Copyright 2015. ISC licensed.
 */
!function(e,t){"use strict";function n(){w.classList.add("hidden"),w.innerHTML="",datepicker.init("datepicker-container-from"),o("data.json","GET",!1,l),B.onkeyup=f,E=M.getElementsByClassName("datepicker-days")[0],T=M.getElementsByClassName("datepicker-months")[0],L=M.getElementsByClassName("datepicker-years")[0],E.onchange=T.onchange=L.onchange=f,I.onclick=y}function r(e){return e===Object(e)}function a(e){try{b=JSON.parse(e);for(var n=t.getElementById("article-list").getElementsByTagName("tbody")[0],r=b.results.length-1;r>=0;r--){var a=n.insertRow(0),i=a.insertCell(0),s=t.createElement("a");s.setAttribute("data-id",r),s.innerHTML=b.results[r].title,s.onclick=u,i.appendChild(s);var l=a.insertCell(1);l.setAttribute("class","read-more"),l.innerHTML='<a  href="'+b.results[r].unescapedUrl+'" target="_blank" >Read more</a>'}}catch(o){console.log(o)}}function i(e){for(var t=Object.keys(e),n="",r=0;r<t.length;r++){var a=e[t[r]];n=t[r]+"="+a}return n}function s(){var t=!1;return e.XMLHttpRequest?t=new XMLHttpRequest:e.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),t}function l(){this.readyState===this.DONE&&(200===this.status?a(this.response):(w.innerHTML="An error has occured",w.classList.remove("hidden")))}function o(e,t,n,a,l){if(""===e)return!1;t=t||"GET",n=n||!0,l=r(l)?i(l):null;var o=s();o!==!1&&("GET"===t&&(e=e+"?"+l,l=null),o.open(t,e,n),"POST"===t&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=a,o.send(l))}function d(){H.classList.remove("hidden")}function c(){H.classList.add("hidden")}function u(){var e=this.getAttribute("data-id");b&&b.results&&(g(b.results[e]),d())}function g(e){var t=H.getElementsByTagName("h1")[0],n=H.getElementsByTagName("h2")[0],r=H.getElementsByTagName("h3")[0],a=H.getElementsByTagName("p")[0];t.innerHTML=e.titleNoFormatting,n.innerHTML=e.publisher,r.innerHTML=e.publishedDate,a.innerHTML=e.content,a.innerHTML+='<a href="'+e.unescapedUrl+'" target="_blank" >Read more</a>',m(e.image),h(e.relatedStories)}function m(e){var n=t.getElementById("article-image-container");n.innerHTML="";var r=t.createElement("a");r.setAttribute("href",e.originalContextUrl);var a=t.createElement("img");a.setAttribute("src",e.url),a.setAttribute("width",e.tbWidth),a.setAttribute("height",e.tbHeight),a.setAttribute("alt",e.publisher),r.appendChild(a),n.appendChild(r)}function h(e){for(var n=t.getElementById("related-articles"),r="",a=0;a<e.length;a++)r='<li><a href="'+e[a].unescapedUrl+'" target="_blank" >'+e[a].title+"</a></li>";n.innerHTML=r}function f(){for(var e=t.getElementById("filter-input").value.toLowerCase(),n=t.getElementById("article-list").getElementsByTagName("tr"),r=0;r<n.length;r++)n[r].classList.remove("hidden");e.length>0&&p(n,e),v(n)}function p(e,t){for(var n=0;n<b.results.length;n++)-1===b.results[n].content.toLowerCase().indexOf(t)&&-1===b.results[n].titleNoFormatting.toLowerCase().indexOf(t)&&e[n].classList.add("hidden")}function v(e){var t;if("--"!==E.options[E.selectedIndex].value&&"--"!==T.options[T.selectedIndex].value&&"--"!==L.options[L.selectedIndex].value){t=new Date(L.options[L.selectedIndex].value+"/"+T.options[T.selectedIndex].value+"/"+E.options[E.selectedIndex].value);for(var n=0;n<b.results.length;n++)new Date(b.results[n].publishedDate).getTime()<t.getTime()&&e[n].classList.add("hidden")}}function y(){c()}var E,T,L,b,B=t.getElementById("filter-input"),H=t.getElementById("overlay"),I=t.getElementById("close-overlay"),M=t.getElementById("datepicker-container-from"),w=t.getElementById("error");n()}(window,document);